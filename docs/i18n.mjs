export const translations = {
  en: {
    title: 'SaveLoc - Bookmark Locations',
    add_location: 'Add Location',
    add_location_title: 'Add new location (uses current GPS)',
    edit_button: 'âœŽ Edit',
    enter_edit_mode: 'Enter Edit Mode',
    exit_edit_mode: 'Exit Edit Mode',
    menu: 'Menu',
    close_menu: 'Close menu',
    clear_all: 'Clear All Locations',
    export_xml: 'Export as XML',
    import_xml: 'Import XML',
    saved_locations: 'Saved Locations',
    no_locations: 'No locations saved yet.',
    edit_location: 'Edit Location',
    label: 'Label:',
    label_placeholder: 'E.g., Home, Work',
    latitude: 'Latitude:',
    longitude: 'Longitude:',
    update_to_current: 'ðŸŽ¯ Update to Current',
    save_changes: 'Save Changes',
    cancel: 'Cancel',
    add_new_location: 'Add New Location',
    location_placeholder: 'E.g., Home, Work, Park Entrance',
    save_location: 'Save Location',
    fetching: 'Fetching...',
    geolocation_unsupported: 'Geolocation is not supported by your browser',
    error_getting_current: 'Error getting current location: {error}',
    invalid_input: 'Invalid input',
    no_locations_to_clear: 'There are no locations to clear.',
    confirm_delete_all: 'Are you sure you want to delete ALL locations? This cannot be undone.',
    no_locations_to_export: 'No locations to export.',
    error_parsing_xml: 'Error parsing XML file. Please check the file format.',
    no_locations_in_file: 'No locations found in the XML file.',
    locations_imported: '{count} location(s) imported successfully.',
    an_error_occurred: 'An error occurred while processing the XML file.',
    error_reading_file: 'Error reading file.',
    location_permission_denied: 'Location permission denied.',
    location_permission_denied_enable: 'Location permission denied. Enable it in your browser settings.',
    force_refresh: 'Force Refresh',
    map_layer: 'Map Layer',
    no_internet: 'No internet connection. Unable to refresh.'
  },
  nl: {
    title: 'SaveLoc - Locaties opslaan',
    add_location: 'Locatie toevoegen',
    add_location_title: 'Nieuwe locatie toevoegen (gebruikt GPS)',
    edit_button: 'âœŽ Bewerken',
    enter_edit_mode: 'Bewerkmodus starten',
    exit_edit_mode: 'Bewerkmodus verlaten',
    menu: 'Menu',
    close_menu: 'Menu sluiten',
    clear_all: 'Alle locaties verwijderen',
    export_xml: 'Exporteren als XML',
    import_xml: 'XML importeren',
    saved_locations: 'Opgeslagen locaties',
    no_locations: 'Nog geen locaties opgeslagen.',
    edit_location: 'Locatie bewerken',
    label: 'Label:',
    label_placeholder: 'Bijv. Thuis, Werk',
    latitude: 'Breedtegraad:',
    longitude: 'Lengtegraad:',
    update_to_current: 'ðŸŽ¯ Bijwerken naar huidige',
    save_changes: 'Wijzigingen opslaan',
    cancel: 'Annuleren',
    add_new_location: 'Nieuwe locatie toevoegen',
    location_placeholder: 'Bijv. Thuis, Werk, Park-ingang',
    save_location: 'Locatie opslaan',
    fetching: 'Bezig...',
    geolocation_unsupported: 'Geolocatie wordt niet ondersteund door je browser',
    error_getting_current: 'Fout bij ophalen huidige locatie: {error}',
    invalid_input: 'Ongeldige invoer',
    no_locations_to_clear: 'Er zijn geen locaties om te wissen.',
    confirm_delete_all: 'Weet je zeker dat je ALLE locaties wilt verwijderen? Dit kan niet ongedaan worden.',
    no_locations_to_export: 'Geen locaties om te exporteren.',
    error_parsing_xml: 'Fout bij het lezen van het XML-bestand. Controleer het formaat.',
    no_locations_in_file: 'Geen locaties gevonden in het XML-bestand.',
    locations_imported: '{count} locatie(s) succesvol geÃ¯mporteerd.',
    an_error_occurred: 'Er is een fout opgetreden bij het verwerken van het XML-bestand.',
    error_reading_file: 'Fout bij het lezen van het bestand.',
    location_permission_denied: 'Locatietoestemming geweigerd.',
    location_permission_denied_enable: 'Locatietoestemming geweigerd. Schakel dit in je browser in.',
    force_refresh: 'Ververs alles',
    map_layer: 'Kaartlaag',
    no_internet: 'Geen internetverbinding. Kan niet verversen.'
  },
  de: {
    title: 'SaveLoc - Orte speichern',
    add_location: 'Standort hinzufÃ¼gen',
    add_location_title: 'Neuen Standort hinzufÃ¼gen (verwendet GPS)',
    edit_button: 'âœŽ Bearbeiten',
    enter_edit_mode: 'Bearbeitungsmodus starten',
    exit_edit_mode: 'Bearbeitungsmodus beenden',
    menu: 'MenÃ¼',
    close_menu: 'MenÃ¼ schlieÃŸen',
    clear_all: 'Alle Standorte lÃ¶schen',
    export_xml: 'Als XML exportieren',
    import_xml: 'XML importieren',
    saved_locations: 'Gespeicherte Standorte',
    no_locations: 'Noch keine Standorte gespeichert.',
    edit_location: 'Standort bearbeiten',
    label: 'Bezeichnung:',
    label_placeholder: 'z.B. Zuhause, Arbeit',
    latitude: 'Breitengrad:',
    longitude: 'LÃ¤ngengrad:',
    update_to_current: 'ðŸŽ¯ Auf aktuelle aktualisieren',
    save_changes: 'Ã„nderungen speichern',
    cancel: 'Abbrechen',
    add_new_location: 'Neuen Standort hinzufÃ¼gen',
    location_placeholder: 'z.B. Zuhause, Arbeit, Parkeingang',
    save_location: 'Standort speichern',
    fetching: 'LÃ¤dt...',
    geolocation_unsupported: 'Geolocation wird von deinem Browser nicht unterstÃ¼tzt',
    error_getting_current: 'Fehler beim Abrufen des aktuellen Standorts: {error}',
    invalid_input: 'UngÃ¼ltige Eingabe',
    no_locations_to_clear: 'Keine Standorte zum LÃ¶schen.',
    confirm_delete_all: 'MÃ¶chtest du wirklich ALLE Standorte lÃ¶schen? Dies kann nicht rÃ¼ckgÃ¤ngig gemacht werden.',
    no_locations_to_export: 'Keine Standorte zum Exportieren.',
    error_parsing_xml: 'Fehler beim Parsen der XML-Datei. Bitte Dateiformat prÃ¼fen.',
    no_locations_in_file: 'Keine Standorte in der XML-Datei gefunden.',
    locations_imported: '{count} Standort(e) erfolgreich importiert.',
    an_error_occurred: 'Beim Verarbeiten der XML-Datei ist ein Fehler aufgetreten.',
    error_reading_file: 'Fehler beim Lesen der Datei.',
    location_permission_denied: 'Standortberechtigung verweigert.',
    location_permission_denied_enable: 'Standortberechtigung verweigert. Aktiviere sie in deinen Browsereinstellungen.',
    force_refresh: 'Alles neu laden',
    map_layer: 'Kartenansicht',
    no_internet: 'Keine Internetverbindung. Aktualisierung nicht mÃ¶glich.'
  }
};

let currentLang = null;

export function getUserLanguage() {
  const langs = navigator.languages || [navigator.language || 'en'];
  for (const lang of langs) {
    const short = lang.toLowerCase().split('-')[0];
    if (translations[short]) return short;
  }
  return 'en';
}

export function t(key, vars = {}) {
  if (!currentLang) currentLang = getUserLanguage();
  const str = (translations[currentLang] && translations[currentLang][key]) || translations.en[key] || key;
  return str.replace(/\{(\w+)\}/g, (_, k) => vars[k] ?? `{${k}}`);
}

export function applyTranslations() {
  currentLang = getUserLanguage();
  document.documentElement.lang = currentLang;
  document.querySelectorAll('[data-i18n]').forEach(el => {
    const key = el.getAttribute('data-i18n');
    el.textContent = t(key);
  });
  document.querySelectorAll('[data-i18n-placeholder]').forEach(el => {
    const key = el.getAttribute('data-i18n-placeholder');
    el.setAttribute('placeholder', t(key));
  });
  document.querySelectorAll('[data-i18n-title]').forEach(el => {
    const key = el.getAttribute('data-i18n-title');
    el.setAttribute('title', t(key));
  });
  document.querySelectorAll('[data-i18n-aria-label]').forEach(el => {
    const key = el.getAttribute('data-i18n-aria-label');
    el.setAttribute('aria-label', t(key));
  });
}

